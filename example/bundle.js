!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require){var reactive=require("reactive"),touch=require("../"),opts={tap:{requireFailure:"mycustomtap"},mycustomtap:{taps:2,"with":"tap"}},view=reactive(template,{},{bindings:touch(null,opts),delegate:{toggle:function(ev,ctx){ctx.set("active",!ctx.model.active)},swipeleft:function(ev,ctx){ctx.set("distance",ev.distance)},tap:function(ev,ctx){ctx.set("tapped",ev.type)}}});document.getElementById("example").appendChild(view.el)},{"../":3,reactive:10}],2:[function(require){function code(title,lang,src){var enc=src.replace(/[\u00A0-\u9999<>\&]/gim,function(i){return"&#"+i.charCodeAt(0)+";"});document.getElementById("sources").insertAdjacentHTML("beforeend",'<div class="col sourcecode"><h2>'+title+'</h2><pre><code class="'+lang+'">'+enc+"</code></pre></div>")}template="<div class=\"col area {active && 'active'}\" \r\n  on-swipeleft swipe-threshold=\"150\" \r\n  swipe-enable=\"{active}\">\r\n  { active ? 'Swipe > 150px left' : 'Disabled' }\r\n</div>\r\n<div class=\"col\">\r\n  <button on-tap=\"toggle\">\r\n    {active ? 'Deactivate' : 'Activate'}\r\n  </button>\r\n  <button on-tap on-mycustomtap=\"tap\">\r\n    Tap or doubletap me\r\n  </button>\r\n  <p>\r\n    Tapped: {tapped || 'none'}. \r\n    Swiped: {distance || '0'}px\r\n  </p>\r\n</div>\r\n",js="var reactive = require('reactive')\r\n  , touch = require('../')\r\n\r\nvar opts = {\r\n  tap: { requireFailure: 'mycustomtap' },\r\n  mycustomtap: { taps: 2, with: 'tap'  }\r\n}\r\n\r\nvar view  = reactive(template, {}, {\r\n  bindings: touch(null, opts),\r\n  delegate: {\r\n    toggle: function(ev, ctx) {\r\n      ctx.set('active', !ctx.model.active)\r\n    },\r\n    swipeleft: function(ev, ctx) {\r\n      ctx.set('distance', ev.distance)\r\n    },\r\n    tap: function(ev, ctx) {\r\n      ctx.set('tapped', ev.type)\r\n    }\r\n  }\r\n})\r\n\r\ndocument.getElementById('example')\r\n .appendChild(view.el)\r\n";var proto=require("hammerjs").Swipe.prototype,old=proto.attrTest;proto.attrTest=function(input){return old.call(this,input)&&input.distance>this.options.threshold},require("./example.js"),code("Template","html",template),code("Javascript","javascript",js),hljs.initHighlightingOnLoad()},{"./example.js":1,hammerjs:4}],3:[function(require,module){function bind(bindings,name,opts){var suffixes=eventSuffixes[opts.recognizer]||[];suffixes.push(""),suffixes.forEach(function(suffix){var event=name+suffix;bindings["on-"+event]=function(el,method){method||(method=event);var react=this.reactive,manager=getManager(el,name,opts,react);manager.on(event,function(ev){callMethod(react.view,method,[ev,react])})}})}function getManager(el,name,opts,reactive){function option(key){return el.getAttribute(name+"-"+key)||opts[key]}var manager=el.hammer;if(null==manager&&(manager=el.hammer=new Hammer.Manager(el),manager.onCreated={},reactive.on("destroyed",function(){el.hammer.destroy(),delete el.hammer})),null==manager[name]){opts.event=name;var recog=new Hammer[opts.recognizer](opts);manager[name]=recog,manager.add(recog),getOptions(recog).forEach(function(option){var expr=el.getAttribute(name+"-"+option);if(null!=expr)if(utils.hasInterpolation(expr)){var update=function(){var raw=utils.interpolate(expr,function(prop,fn){return fn?fn(reactive):reactive.get(prop)});setOption(recog,option,raw)},props=utils.interpolationProps(expr);props.forEach(function(prop){reactive.sub(prop,update)}),update()}else setOption(recog,option,expr)});var rw=option("with");rw&&getRecognizer(manager,rw,function(other){recog.recognizeWith(other)});var rf=option("requireFailure");rf&&getRecognizer(manager,rf,function(other){manager.add(other),manager.add(recog),recog.requireFailure(other)});var setup=option("setup");if(setup&&callMethod(reactive.view,setup,[el,recog,reactive]),manager.onCreated[name]){var queue=manager.onCreated[name];delete manager.onCreated[name];for(var i=queue.length-1;i>=0;i--)queue[i](recog)}}return manager}function guessRecognizer(name){for(var i=recognizers.length-1;i>=0;i--)if(name.indexOf(recognizers[i])>=0)return recognizers[i];throw new Error("Could not guess recognizer name, please set opts.recognizer")}function getRecognizer(manager,name,cb){if(manager[name])return cb(manager[name]);var queue=manager.onCreated;queue[name]?queue[name].push(cb):queue[name]=[cb]}function callMethod(view,method,args){var fn="function"==typeof method?method:view[method];if(!fn)throw new Error("method ."+method+"() missing");return fn.apply(view,args)}function getOptions(recog){var names=[];for(var k in recog.defaults)"event"!==k&&names.push(k);return names.indexOf("enable")<0&&names.push("enable"),names}function setOption(recog,option,raw){var parser=optionParsers[option]||parseInt,opts={};opts[option]=parser(raw),recog.set(opts)}for(var Hammer=require("hammerjs"),utils=require("reactive/lib/utils"),recognizers=["pan","pinch","press","rotate","swipe","tap"],defaults={},i=recognizers.length-1;i>=0;i--)defaults[recognizers[i]]={recognizer:recognizers[i],enable:!0};var eventSuffixes={Pan:["start","move","end","cancel","left","right","up","down"],Pinch:["start","move","end","cancel","in","out"],Rotate:["start","move","end","cancel"],Swipe:["left","right","up","down"]},optionParsers={velocity:parseFloat,enable:function(val){return"false"==val||"undefined"==val?!1:!!val},direction:function(val){if("number"==typeof val)return val;var constant=Hammer["DIRECTION_"+val.toUpperCase()];return null!=constant?constant:parseInt(val)}};module.exports=function(bindings,opts){if(bindings&&bindings.bindings)throw new Error("As of 1.0.0, you must wrap bindings with touch() instead of view.use(touch)");bindings||(bindings={});var name,opt,merged={};for(name in defaults){merged[name]={};for(opt in defaults[name])merged[name][opt]=defaults[name][opt]}if(opts)for(name in opts){merged[name]||(merged[name]={});for(opt in opts[name])merged[name][opt]=opts[name][opt]}for(var name in merged){var group=merged[name];name=name.toLowerCase();var rgn=group.recognizer||guessRecognizer(name);group.recognizer=rgn[0].toUpperCase()+rgn.slice(1),group.direction&&(group.direction=optionParsers.direction(group.direction)),bind(bindings,name,group)}return bindings}},{hammerjs:4,"reactive/lib/utils":12}],4:[function(require,module){!function(window,document,exportName,undefined){"use strict";function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return Array.isArray(arg)?(each(arg,context[fn],context),!0):!1}function each(obj,iterator,context){var i,len;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0,len=obj.length;len>i;i++)iterator.call(context,obj[i],i,obj);else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function extend(dest,src,merge){for(var keys=Object.keys(src),i=0,len=keys.length;len>i;i++)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]);return dest}function merge(dest,src){return extend(dest,src,!0)}function inherit(child,base,properties){var childP,baseP=base.prototype;childP=child.prototype=Object.create(baseP),childP.constructor=child,childP._super=baseP,properties&&extend(childP,properties)}function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return typeof val==TYPE_FUNCTION?val.apply(args?args[0]||undefined:undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(element,types,handler){each(splitStr(types),function(type){element.addEventListener(type,handler,!1)})}function removeEventListeners(element,types,handler){each(splitStr(types),function(type){element.removeEventListener(type,handler,!1)})}function hasParent(node,parent){for(;node;){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0,len=src.length;len>i;i++)if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0,len=src.length;len>i;i++){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val}return sort&&(results=key?results.sort(function(a,b){return a[key]>b[key]}):results.sort()),results}function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0,len=VENDOR_PREFIXES.length;len>i;i++)if(prefix=VENDOR_PREFIXES[i],prop=prefix?prefix+camelProp:property,prop in obj)return prop;return undefined}function uniqueId(){return _uniqueId++}function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(window,this.evWin,this.domHandler)}function createInputInstance(manager){var Type;return new(Type=SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput)(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),computeDeltaXY(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY),input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0,computeIntervalInputData(session,input);var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target),input.target=target}function computeDeltaXY(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};(input.eventType===INPUT_START||prevInput.eventType===INPUT_END)&&(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=last.deltaX-input.deltaX,deltaY=last.deltaY-input.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;i++)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)};return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;pointersLength>i;i++)x+=pointers[i].clientX,y+=pointers[i].clientY;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x>0?DIRECTION_LEFT:DIRECTION_RIGHT:y>0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)-getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.allow=!0,this.pressed=!1,Input.apply(this,arguments)}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}function getTouches(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,len,targetTouches=toArray(ev.targetTouches),changedTouches=toArray(ev.changedTouches),changedTargetTouches=[];if(type===INPUT_START)for(i=0,len=targetTouches.length;len>i;i++)targetIds[targetTouches[i].identifier]=!0;for(i=0,len=changedTouches.length;len>i;i++)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier];return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler)}function TouchAction(manager,value){this.manager=manager,this.set(value)}function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);return hasPanX&&hasPanY?TOUCH_ACTION_PAN_X+" "+TOUCH_ACTION_PAN_Y:hasPanX||hasPanY?hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y:inStr(actions,TOUCH_ACTION_MANIPULATION)?TOUCH_ACTION_MANIPULATION:TOUCH_ACTION_AUTO}function Recognizer(options){this.id=uniqueId(),this.manager=null,this.options=merge(options||{},this.defaults),this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return state&STATE_CANCELLED?"cancel":state&STATE_ENDED?"end":state&STATE_CHANGED?"move":state&STATE_BEGAN?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return options=options||{},options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}function Manager(element,options){options=options||{},this.options=merge(options,Hammer.defaults),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.element=element,this.input=createInputInstance(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[2])},this)}function toggleCssProps(manager,add){var element=manager.element;each(manager.options.cssProps,function(value,name){element.style[prefixed(element.style,name)]=add?value:""})}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}var VENDOR_PREFIXES=["","webkit","moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now,_uniqueId=1,MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent),INPUT_TYPE_TOUCH="touch",INPUT_TYPE_PEN="pen",INPUT_TYPE_MOUSE="mouse",INPUT_TYPE_KINECT="kinect",COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_MOVE=2,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];Input.prototype={handler:function(){},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(window,this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";inherit(MouseInput,Input,{handler:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),eventType&INPUT_MOVE&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&this.allow&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev}))}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";window.MSPointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch=pointerType==INPUT_TYPE_TOUCH;eventType&INPUT_START&&(0===ev.button||isTouch)?store.push(ev):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0);var storeIndex=inArray(store,ev.pointerId,"pointerId");0>storeIndex||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";inherit(TouchInput,Input,{handler:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}}),inherit(TouchMouseInput,Input,{handler:function(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(isTouch)this.mouse.allow=!1;else if(isMouse&&!this.mouse.allow)return;inputEvent&(INPUT_END|INPUT_CANCEL)&&(this.mouse.allow=!0),this.callback(manager,inputEvent,inputData)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_COMPUTE="compute",TOUCH_ACTION_AUTO="auto",TOUCH_ACTION_MANIPULATION="manipulation",TOUCH_ACTION_NONE="none",TOUCH_ACTION_PAN_X="pan-x",TOUCH_ACTION_PAN_Y="pan-y";TouchAction.prototype={set:function(value){value==TOUCH_ACTION_COMPUTE&&(value=this.compute()),NATIVE_TOUCH_ACTION&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),cleanTouchActions(actions.join(" "))},preventDefaults:function(input){if(!NATIVE_TOUCH_ACTION){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)return void srcEvent.preventDefault();var actions=this.actions,hasNone=inStr(actions,TOUCH_ACTION_NONE),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y),hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);return hasNone||hasPanY&&hasPanX||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0}},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1,STATE_BEGAN=2,STATE_CHANGED=4,STATE_ENDED=8,STATE_RECOGNIZED=STATE_ENDED,STATE_CANCELLED=16,STATE_FAILED=32;Recognizer.prototype={defaults:{},set:function(options){return extend(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),simultaneous[otherRecognizer.id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this)},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),-1===inArray(requireFail,otherRecognizer)&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){function emit(withState){self.manager.emit(self.options.event+(withState?stateStr(state):""),input)}var self=this,state=this.state;STATE_ENDED>state&&emit(!0),emit(),state>=STATE_ENDED&&emit(!0)},tryEmit:function(input){return this.canEmit()?this.emit(input):void(this.state=STATE_FAILED)},canEmit:function(){for(var i=0;i<this.requireFail.length;i++)if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE)))return!1;return!0},recognize:function(inputData){var inputDataClone=extend({},inputData);return boolOrFn(this.options.enable,[this,inputDataClone])?(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),void(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)&&this.tryEmit(inputDataClone))):(this.reset(),void(this.state=STATE_FAILED))},process:function(){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=state&(STATE_BEGAN|STATE_CHANGED),isValid=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!isValid)?state|STATE_CANCELLED:isRecognized||isValid?eventType&INPUT_END?state|STATE_ENDED:state&STATE_BEGAN?state|STATE_CHANGED:STATE_BEGAN:STATE_FAILED}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction;if(direction===DIRECTION_ALL)return[TOUCH_ACTION_NONE];var actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push(TOUCH_ACTION_PAN_Y),direction&DIRECTION_VERTICAL&&actions.push(TOUCH_ACTION_PAN_X),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=0===x?DIRECTION_NONE:0>x?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=0===y?DIRECTION_NONE:0>y?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&this.manager.emit(this.options.event+direction,input),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(this._super.emit.call(this,input),1!==input.scale){var inOut=input.scale<1?"in":"out";this.manager.emit(this.options.event+inOut,input)}}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){this.state===STATE_RECOGNIZED&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var velocity,direction=this.options.direction;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.velocity:direction&DIRECTION_HORIZONTAL?velocity=input.velocityX:direction&DIRECTION_VERTICAL&&(velocity=input.velocityY),this._super.attrTest.call(this,input)&&direction&input.direction&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.direction);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:!0,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input;var tapCount=this.count%options.taps;if(0===tapCount)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.interval,this),STATE_BEGAN):STATE_RECOGNIZED}return STATE_FAILED},failTimeout:function(){return this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this),STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==STATE_RECOGNIZED&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.2",Hammer.defaults={domEvents:!1,touchAction:TOUCH_ACTION_COMPUTE,inputTarget:null,enable:!0,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};
var STOP=1,FORCED_STOP=2;Manager.prototype={set:function(options){return extend(this.options,options),this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(!session.stopped){this.touchAction.preventDefaults(inputData);var recognizer,recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)&&(curRecognizer=session.curRecognizer=null);for(var i=0,len=recognizers.length;len>i;i++)recognizer=recognizers[i],session.stopped===FORCED_STOP||curRecognizer&&recognizer!=curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)&&(curRecognizer=session.curRecognizer=recognizer)}},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;var recognizers=this.recognizers;return recognizer=this.get(recognizer),recognizers.splice(inArray(recognizers,recognizer),1),this.touchAction.update(),this},on:function(events,handler){var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this},off:function(events,handler){var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this},emit:function(event,data){this.options.domEvents&&triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0,len=handlers.length;len>i;i++)handlers[i](data)}},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},extend(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,inherit:inherit,bindFn:bindFn,prefixed:prefixed}),typeof define==TYPE_FUNCTION&&define.amd?define(function(){return Hammer}):"undefined"!=typeof module&&module.exports?module.exports=Hammer:window[exportName]=Hammer}(window,document,"Hammer")},{}],5:[function(require,module){function Adapter(obj){if(!(this instanceof Adapter))return new Adapter(obj);var self=this;self.obj=obj}Adapter.prototype.subscribe=function(){},Adapter.prototype.unsubscribe=function(){},Adapter.prototype.unsubscribeAll=function(){},Adapter.prototype.set=function(prop,val){var obj=this.obj;obj&&("function"==typeof obj[prop]?obj[prop](val):"function"==typeof obj.set?obj.set(prop,val):obj[prop]=val)},Adapter.prototype.get=function(prop){var obj=this.obj;if(!obj)return void 0;var parts=prop.split("."),part=parts.shift();do{if(obj="function"==typeof obj[part]?obj[part].call(obj):obj[part],!obj)return void 0;part=parts.shift()}while(part);return obj},module.exports=Adapter},{}],6:[function(require,module){function AttrBinding(reactive,node,attr){this.reactive=reactive,this.node=node,this.attr=attr,this.text=attr.value,this.props=utils.interpolationProps(this.text),this.subscribe(),this.render()}var debug=require("debug")("reactive:attr-binding"),utils=require("./utils");module.exports=AttrBinding,AttrBinding.prototype.subscribe=function(){var self=this,reactive=this.reactive;this.props.forEach(function(prop){reactive.sub(prop,function(){self.render()})})},AttrBinding.prototype.render=function(){{var attr=this.attr,text=this.text,reactive=this.reactive;reactive.model}debug('render %s "%s"',attr.name,text),attr.value=utils.interpolate(text,function(prop,fn){return fn?fn(reactive):reactive.get(prop)})}},{"./utils":12,debug:20}],7:[function(require,module){function Binding(name,reactive,el,fn){this.name=name,this.reactive=reactive,this.model=reactive.model,this.view=reactive.view,this.el=el,this.fn=fn}var hasInterpolation=require("./utils").hasInterpolation,interpolationProps=require("./utils").interpolationProps;module.exports=Binding,Binding.prototype.bind=function(){var val=this.el.getAttribute(this.name);this.fn(this.el,val,this.model)},Binding.prototype.interpolate=function(name){var self=this;return~name.indexOf("{")?name.replace(/{([^}]+)}/g,function(_,name){return self.value(name)}):self.value(name)},Binding.prototype.value=function(name){return this.reactive.get(name)},Binding.prototype.change=function(fn){fn.call(this);var self=this,reactive=this.reactive,val=this.el.getAttribute(this.name);if(hasInterpolation(val)){var props=interpolationProps(val);return void props.forEach(function(prop){reactive.sub(prop,fn.bind(self))})}var prop=val;reactive.sub(prop,fn.bind(this))}},{"./utils":12}],8:[function(require,module){var carry=require("carry"),classes=require("classes"),event=require("event"),each_binding=require("./each"),attrs=["id","src","rel","cols","rows","name","href","title","class","style","width","value","height","tabindex","placeholder"],events=["change","click","dblclick","mousedown","mouseup","mouseenter","mouseleave","scroll","blur","focus","input","submit","keydown","keypress","keyup"];module.exports=function(reactive){reactive.bind("each",each_binding),attrs.forEach(function(attr){reactive.bind("data-"+attr,function(el,name){var change=function(){el.setAttribute(attr,this.interpolate(name))};~["INPUT","TEXTAREA"].indexOf(el.tagName)&&"value"===attr&&(change=function(){el.value=this.interpolate(name)}),this.change(change)})}),reactive.bind("data-visible",function(el,name){this.change(function(){var val=this.value(name);val?classes(el).add("visible").remove("hidden"):classes(el).remove("visible").add("hidden")})}),reactive.bind("data-hidden",function(el,name){this.change(function(){var val=this.value(name);val?classes(el).remove("visible").add("hidden"):classes(el).add("visible").remove("hidden")})}),reactive.bind("data-checked",function(el,name){this.change(function(){this.value(name)?el.setAttribute("checked","checked"):el.removeAttribute("checked")})}),reactive.bind("data-selected",function(el,name){this.change(function(){this.value(name)?el.setAttribute("selected","selected"):el.removeAttribute("selected")})}),reactive.bind("data-text",function(el,name){var change=function(){el.textContent=this.interpolate(name)};"TEXTAREA"===el.tagName&&(change=function(){el.value=this.interpolate(name)}),this.change(change)}),reactive.bind("data-html",function(el,name){this.change(function(){el.innerHTML=this.interpolate(name)})}),events.forEach(function(name){reactive.bind("on-"+name,function(el,method){var self=this,view=self.reactive.view;event.bind(el,name,function(e){e.preventDefault();var fn=view[method];if(!fn)throw new Error("method ."+method+"() missing");fn.call(view,e,self.reactive)})})}),reactive.bind("data-append",function(el,name){var other=this.value(name);el.appendChild(other)}),reactive.bind("data-replace",function(el,name){var other=carry(this.value(name),el);el.parentNode.replaceChild(other,el)})}},{"./each":9,carry:14,classes:18,event:23}],9:[function(require,module){module.exports=function(el,val){function childView(el,model){return Reactive(el,model,{delegate:self.view,adapter:self.reactive.opt.adapter,bindings:self.reactive.bindings})}function change(arr){views.forEach(function(view){view.destroy()}),views=[],array&&unpatchArray(array),patchArray(arr),array=arr;var fragment=document.createDocumentFragment();arr.forEach(function(obj){var clone=el.cloneNode(!0),view=childView(clone,obj);views.push(view),fragment.appendChild(clone)}),parent.insertBefore(fragment,placeholder)}function unpatchArray(arr){delete arr.splice,delete arr.push,delete arr.unshift}function patchArray(arr){function set_prop(prop,fn){Object.defineProperty(arr,prop,{enumerable:!1,writable:!0,configurable:!0,value:fn})}var old_splice=arr.splice,splice=function(idx,how_many){var args=Array.prototype.slice.apply(arguments),new_items=args.slice(2),place=placeholder;idx<views.length&&(place=views[idx].el);var new_views=new_items.map(function(item){var clone=el.cloneNode(!0);return childView(clone,item)}),splice_args=[idx,how_many].concat(new_views),removed=views.splice.apply(views,splice_args),frag=document.createDocumentFragment();new_views.forEach(function(view){frag.appendChild(view.el)}),parent.insertBefore(frag,place),removed.forEach(function(view){view.destroy()});var ret=old_splice.apply(arr,args);return self.reactive.set(prop+".length",arr.length),ret},push=function(){var args=Array.prototype.slice.apply(arguments),len=arr.length,splice_args=[len,0].concat(args);return splice.apply(arr,splice_args),arr.length},unshift=function(){var args=Array.prototype.slice.apply(arguments),splice_args=(arr.length,[0,0].concat(args));return splice.apply(arr,splice_args),arr.length},pop=function(){if(!arr.length)return void 0;var element=arr[arr.length-1];return splice.apply(arr,[arr.length-1,1]),element},shift=function(){if(!arr.length)return void 0;var element=arr[0];return splice.apply(arr,[0,1]),element},sort=function(){var ret=Array.prototype.sort.apply(arr,arguments),arr2=[0,arr.length].concat(arr);return splice.apply(arr,arr2),ret},reverse=function(){var ret=Array.prototype.reverse.apply(arr),arr2=[0,arr.length].concat(arr);return splice.apply(arr,arr2),ret};set_prop("splice",splice),set_prop("push",push),set_prop("unshift",unshift),set_prop("pop",pop),set_prop("shift",shift),set_prop("sort",sort),set_prop("reverse",reverse)}var self=this,Reactive=self.reactive.constructor,val=val.split(/ +/);el.removeAttribute("each");var name=val[0],prop=val[0];val.length>1&&(name=val[0],prop=val[2]);var parent=el.parentNode,placeholder=document.createTextNode("");parent.insertBefore(placeholder,el),parent.removeChild(el);var array,views=[];change(self.reactive.get(prop)||[]),self.skip=!0,self.reactive.sub(prop,change)}},{}],10:[function(require,module,exports){function Reactive(el,model,opt){if(!(this instanceof Reactive))return new Reactive(el,model,opt);opt=opt||{},"string"==typeof el&&(el=domify(el));var self=this;self.opt=opt||{},self.model=model||{},self.adapter=(opt.adapter||Adapter)(self.model),self.el=el,self.view=opt.delegate||Object.create(null),self.bindings=opt.bindings||Object.create(null),bindings({bind:function(name,fn){self.bindings[name]=fn}}),self._bind(this.el,[])}var Emitter=require("emitter"),query=require("query"),domify=require("domify"),debug=require("debug")("reactive"),Adapter=require("./adapter"),AttrBinding=require("./attr-binding"),TextBinding=require("./text-binding"),bindings=require("./bindings"),Binding=require("./binding"),utils=require("./utils"),walk=require("./walk");exports=module.exports=Reactive,Emitter(Reactive.prototype),Reactive.prototype.sub=function(prop,fn){var self=this;debug("subscribe %s",prop);var parts=prop.split(".");return parts.length>1&&self.sub(parts[0],function(){fn(self.get(prop))}),self.on("change "+prop,fn),self.adapter.subscribe(prop,function(){self._internal_set||fn.apply(this,arguments)}),self},Reactive.prototype.unsub=function(prop,fn){return this.off("change "+prop,fn),this.adapter.unsubscribe(prop,fn),this},Reactive.prototype.get=function(prop){if("this"===prop)return this.model;var modelVal=this.adapter.get(prop);if(modelVal)return modelVal;var view=this.view,viewVal=view[prop];return"function"==typeof viewVal?viewVal.call(view):viewVal?viewVal:void 0},Reactive.prototype.set=function(prop,val){var self=this;return self._internal_set=!0,"object"==typeof prop?Object.keys(prop).forEach(function(name){self.set(name,prop[name])}):(self.adapter.set(prop,val),self.emit("change "+prop,val)),self._internal_set=!1,self},Reactive.prototype.bindInterpolation=function(el,els){if(1==el.nodeType)for(var i=0;i<el.attributes.length;i++){var attr=el.attributes[i];utils.hasInterpolation(attr.value)&&new AttrBinding(this,el,attr)}3==el.nodeType&&utils.hasInterpolation(el.data)&&(debug('bind text "%s"',el.data),new TextBinding(this,el));for(var i=0;i<el.childNodes.length;i++){var node=el.childNodes[i];this.bindInterpolation(node,els)}},Reactive.prototype._bind=function(){var self=this,bindings=self.bindings;walk(self.el,function(el,next){if(1==el.nodeType){for(var skip=!1,attrs={},i=0;i<el.attributes.length;++i){var attr=el.attributes[i],name=attr.name;attrs[name]=attr}if(Object.keys(bindings).forEach(function(name){if(attrs[name]&&!skip){debug("bind [%s]",name);var binding_fn=(attrs[name].value,bindings[name]);if(binding_fn){var binding=new Binding(name,self,el,binding_fn);binding.bind(),binding.skip&&(skip=!0)}}}),skip)return next(skip);for(var i=0;i<el.attributes.length;++i){var attr=el.attributes[i],name=attr.name;utils.hasInterpolation(attr.value)&&new AttrBinding(self,el,attr)}return next(skip)}3==el.nodeType&&utils.hasInterpolation(el.data)&&(debug('bind text "%s"',el.data),new TextBinding(self,el)),next()})},Reactive.prototype.bind=function(name,fn){if("object"!=typeof name){var els=query.all("["+name+"]",this.el);if(this.el.hasAttribute&&this.el.hasAttribute(name)&&(els=[].slice.call(els),els.unshift(this.el)),els.length){debug("bind [%s] (%d elements)",name,els.length);for(var i=0;i<els.length;i++){var binding=new Binding(name,this,els[i],fn);binding.bind()}}}else for(var key in name)this.bind(key,name[key])},Reactive.prototype.destroy=function(){var self=this;self.el.parentNode&&self.el.parentNode.removeChild(self.el),self.adapter.unsubscribeAll(),self.emit("destroyed"),self.removeAllListeners()},Reactive.prototype.use=function(fn){return fn(this),this}},{"./adapter":5,"./attr-binding":6,"./binding":7,"./bindings":8,"./text-binding":11,"./utils":12,"./walk":13,debug:20,domify:21,emitter:22,query:24}],11:[function(require,module){function TextBinding(reactive,node){this.reactive=reactive,this.text=node.data,this.node=node,this.props=utils.interpolationProps(this.text),this.subscribe(),this.render()}var debug=require("debug")("reactive:text-binding"),utils=require("./utils");module.exports=TextBinding,TextBinding.prototype.subscribe=function(){var self=this,reactive=this.reactive;this.props.forEach(function(prop){reactive.sub(prop,function(){self.render()})})},TextBinding.prototype.render=function(){{var node=this.node,text=this.text,reactive=this.reactive;reactive.model}debug('render "%s"',text),node.data=utils.interpolate(text,function(prop,fn){return fn?fn(reactive):reactive.get(prop)})}},{"./utils":12,debug:20}],12:[function(require,module,exports){function compile(expr){var re=/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/g,p=props(expr),funCallRe=/.\w+ *\(/g,body=expr.replace(funCallRe,function(_){return"['"+_.slice(1,-1)+"']("}),body=body.replace(re,function(_){return p.indexOf(_)>=0?access(_):_});return debug("compile `%s`",body),new Function("reactive","return "+body)}function access(prop){return"reactive.get('"+prop+"')"}function unique(arr){for(var ret=[],i=0;i<arr.length;i++)~ret.indexOf(arr[i])||ret.push(arr[i]);return ret}var debug=require("debug")("reactive:utils"),cache={},props=function(str){return str.replace(/\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").match(/[a-zA-Z_]\w*([.][a-zA-Z_]\w*)*/g)||[]};exports.interpolationProps=function(str){for(var m,arr=[],re=/\{([^}]+)\}/g;m=re.exec(str);){var expr=m[1];arr=arr.concat(props(expr))}return unique(arr)},exports.interpolate=function(str,fn){return str.replace(/\{([^}]+)\}/g,function(_,expr){var cb=cache[expr];cb||(cb=cache[expr]=compile(expr));var val=fn(expr.trim(),cb);return null==val?"":val})},exports.hasInterpolation=function(str){return~str.indexOf("{")}},{debug:20}],13:[function(require,module){module.exports=function walk(el,process,done){function next(stop){return stop||0===nodes.length?end():void walk(nodes.shift(),process,next)}var end=done||function(){},nodes=[].slice.call(el.childNodes);process(el,next)}},{}],14:[function(require,module){function carry(a,b){return a?(carry.attrs(a,b),carry.classes(a,b),a):b.cloneNode()}var merge=require("./lib/merge-attrs"),classes=require("classes"),uniq=require("uniq");module.exports=carry,carry.attrs=function(a,b){return merge(a,b),a},carry.classes=function(a,b){if(a.className==b.className)return a;var blist=classes(b).array(),alist=classes(a).array(),list=alist.concat(blist);return a.className=uniq(list).join(" "),a}},{"./lib/merge-attrs":15,classes:18,uniq:16}],15:[function(require,module){function merge(a,b){for(var i=0;i<b.attributes.length;++i){var attr=b.attributes[i];ignore(a,attr)||a.setAttribute(attr.name,attr.value)}}function ignore(a,attr){return!attr.specified||"class"==attr.name||"id"==attr.name||a.hasAttribute(attr.name)}module.exports=merge},{}],16:[function(require,module){var indexOf=require("indexof");module.exports=function(arr,select){var v,len=arr.length,ret=[];select=select?select instanceof Array?select:[select]:!1;for(var i=0;len>i;i++)v=arr[i],select&&!~indexOf(select,v)?ret.push(v):~indexOf(ret,v)||ret.push(v);return ret}},{indexof:17}],17:[function(require,module){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],18:[function(require,module){function ClassList(el){if(!el)throw new Error("A DOM element reference is required");this.el=el,this.list=el.classList}var index=require("indexof"),re=/\s+/,toString=Object.prototype.toString;module.exports=function(el){return new ClassList(el)},ClassList.prototype.add=function(name){if(this.list)return this.list.add(name),this;var arr=this.array(),i=index(arr,name);return~i||arr.push(name),this.el.className=arr.join(" "),this},ClassList.prototype.remove=function(name){if("[object RegExp]"==toString.call(name))return this.removeMatching(name);if(this.list)return this.list.remove(name),this;var arr=this.array(),i=index(arr,name);return~i&&arr.splice(i,1),this.el.className=arr.join(" "),this},ClassList.prototype.removeMatching=function(re){for(var arr=this.array(),i=0;i<arr.length;i++)re.test(arr[i])&&this.remove(arr[i]);return this},ClassList.prototype.toggle=function(name){return this.list?(this.list.toggle(name),this):(this.has(name)?this.remove(name):this.add(name),this)},ClassList.prototype.array=function(){var str=this.el.className.replace(/^\s+|\s+$/g,""),arr=str.split(re);return""===arr[0]&&arr.shift(),arr},ClassList.prototype.has=ClassList.prototype.contains=function(name){return this.list?this.list.contains(name):!!~index(this.array(),name)}},{indexof:19}],19:[function(require,module){module.exports=require(17)},{}],20:[function(require,module){function debug(name){return debug.enabled(name)?function(fmt){fmt=coerce(fmt);var curr=new Date,ms=curr-(debug[name]||curr);debug[name]=curr,fmt=name+" "+fmt+" +"+debug.humanize(ms),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function coerce(val){return val instanceof Error?val.stack||val.message:val}module.exports=debug,debug.names=[],debug.skips=[],debug.enable=function(name){try{localStorage.debug=name}catch(e){}for(var split=(name||"").split(/[\s,]+/),len=split.length,i=0;len>i;i++)name=split[i].replace("*",".*?"),"-"===name[0]?debug.skips.push(new RegExp("^"+name.substr(1)+"$")):debug.names.push(new RegExp("^"+name+"$"))},debug.disable=function(){debug.enable("")},debug.humanize=function(ms){var sec=1e3,min=6e4,hour=60*min;return ms>=hour?(ms/hour).toFixed(1)+"h":ms>=min?(ms/min).toFixed(1)+"m":ms>=sec?(ms/sec|0)+"s":ms+"ms"},debug.enabled=function(name){for(var i=0,len=debug.skips.length;len>i;i++)if(debug.skips[i].test(name))return!1;for(var i=0,len=debug.names.length;len>i;i++)if(debug.names[i].test(name))return!0;return!1};try{window.localStorage&&debug.enable(localStorage.debug)}catch(e){}},{}],21:[function(require,module){function parse(html){if("string"!=typeof html)throw new TypeError("String expected");var m=/<([\w:]+)/.exec(html);if(!m)return document.createTextNode(html);html=html.replace(/^\s+|\s+$/g,"");var tag=m[1];if("body"==tag){var el=document.createElement("html");return el.innerHTML=html,el.removeChild(el.lastChild)}var wrap=map[tag]||map._default,depth=wrap[0],prefix=wrap[1],suffix=wrap[2],el=document.createElement("div");for(el.innerHTML=prefix+html+suffix;depth--;)el=el.lastChild;if(el.firstChild==el.lastChild)return el.removeChild(el.firstChild);for(var fragment=document.createDocumentFragment();el.firstChild;)fragment.appendChild(el.removeChild(el.firstChild));return fragment}module.exports=parse;var map={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:[0,"",""]};map.td=map.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],map.option=map.optgroup=[1,'<select multiple="multiple">',"</select>"],map.thead=map.tbody=map.colgroup=map.caption=map.tfoot=[1,"<table>","</table>"],map.text=map.circle=map.ellipse=map.line=map.path=map.polygon=map.polyline=map.rect=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"]},{}],22:[function(require,module){function Emitter(obj){return obj?mixin(obj):void 0}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;for(var cb,i=0;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;len>i;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],23:[function(require,module,exports){exports.bind=function(el,type,fn,capture){return el.addEventListener?el.addEventListener(type,fn,capture):el.attachEvent("on"+type,fn),fn},exports.unbind=function(el,type,fn,capture){return el.removeEventListener?el.removeEventListener(type,fn,capture):el.detachEvent("on"+type,fn),fn}},{}],24:[function(require,module,exports){function one(selector,el){return el.querySelector(selector)}exports=module.exports=function(selector,el){return el=el||document,one(selector,el)},exports.all=function(selector,el){return el=el||document,el.querySelectorAll(selector)},exports.engine=function(obj){if(!obj.one)throw new Error(".one callback required");if(!obj.all)throw new Error(".all callback required");one=obj.one,exports.all=obj.all}},{}]},{},[2]);